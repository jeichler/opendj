<!-- 
    Event View for displays (TVs / projectors) at the vent location.
-->
<ion-header no-border color="dark">
    <ion-toolbar color="dark">
        <ion-buttons slot="start">
            <ion-menu-button id="playlist-menu-button" color="light"></ion-menu-button>
        </ion-buttons>
        <ion-title color="light"> EVENT-VIEW {{currentEvent?.name}} - {{currentPlaylist?.nextTracks?.length}} Tracks
        </ion-title>

        <ion-buttons slot="end">
            <ion-icon style="margin:10px; font-size:20px" *ngIf="isConnected" color="light" name="wifi" tooltip="You are connected to the server and receive updates to the playlist automatically" [options]="tooltipOptions"></ion-icon>
        </ion-buttons>

    </ion-toolbar>


</ion-header>

<ion-content color="dark">
    <ion-refresher slot="fixed" (ionRefresh)="refresh($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <ion-grid fixed="false">
        <ion-row>

            <ion-col size="3">
                <ion-img src="assets/img/Logo_OpenDJ_256.png"></ion-img>
            </ion-col>
            <ion-col size="6">
                <ion-toolbar color="dark">
                    <app-current-track *ngIf="currentPlaylist" [currentEventInput]="currentEvent" [trackInput]="currentPlaylist.currentTrack" [isCurator]="false" [isPlaying]="currentPlaylist.isPlaying"></app-current-track>
                </ion-toolbar>
                <ion-grid class="track-grid">
                    <ion-row nowrap *ngFor="let item of currentPlaylist?.nextTracks;  index as i; trackBy: trackElement">

                        <!-- Album Cover-->
                        <ion-col *ngIf="platform.width()>375" size="auto" class="ion-align-self-center">
                            <a href="{{item.image_url_ref}}" target="_blank">
                                <img class="track-cover-pic" src="{{item.image_url}}">
                            </a>
                        </ion-col>

                        <!-- Track Details: 3 rows: Name, Artist, Contributor/Duration/ETA -->
                        <ion-col class="ion-align-self-center ion-text-nowrap">
                            <div class="track-header ion-text-nowrap" tooltip="Name of the track" [options]="tooltipOptions">{{item.name}}</div>
                            <div class="track-details ion-text-nowrap" tooltip="Name of the Artist and year of publication" [options]="tooltipOptions">{{item.artist}}</div>
                            <div class="track-details ion-text-nowrap" tooltip="User who contributed this track and estimated time when this track will be played" [options]="tooltipOptions">{{item.durationStr}} eta {{item.eta}} - {{item.added_by}}</div>
                        </ion-col>


                        <!-- We drop columns when width is not enough. This is indicated with "..." -->
                        <ion-col *ngIf="platform.width()<636" size="auto" class="ion-align-self-center ion-text-nowrap workaroundTransparency" tooltip="Indicates that there is more info available, but not enough space to display. Tip: flip you phone!">
                            <div class="track-meta">
                                ...<br>...<br>...
                            </div>
                        </ion-col>

                        <!-- Track Meta1: 3 rows: genre, year, bpm -->
                        <ion-col *ngIf="platform.width()>=500" size="auto" class="ion-align-self-center ion-text-nowrap workaroundTransparency track-genre-col">
                            <div class="track-meta">{{item.genre}}</div>
                            <div class="track-meta">{{item.year}}</div>
                            <div class="track-meta">{{item.bpm}} bpm</div>
                        </ion-col>

                        <!-- Track Meta2: 3 rows: Danceability, Engery, Happiness, as bars: -->
                        <ion-col *ngIf="platform.width()>=636" size="auto" class="ion-align-self-center ion-text-nowrap workaroundTransparency track-meta-col">
                            <ion-progress-bar value="{{item.danceability / 100.0}}" type="determinate" tooltip="danceability: {{item.danceability}}%" [options]="tooltipOptions" class="track-meta-bar track-meta-bar-danceability"></ion-progress-bar>
                            <ion-progress-bar value="{{item.energy / 100.0}}" type="determinate" tooltip="energy: {{item.energy}}%" [options]="tooltipOptions" class="track-meta-bar track-meta-bar-energy"></ion-progress-bar>
                            <ion-progress-bar value="{{item.happiness / 100.0}}" type="determinate" tooltip="happiness: {{item.happiness}}%" [options]="tooltipOptions" class="track-meta-bar track-meta-bar-happiness"></ion-progress-bar>
                        </ion-col>

                        <!-- Track Feedback: 0-2 rows: Like/Hate Counters. Num rows depends on what is enabled, If none, column is dropped -->
                        <ion-col *ngIf="platform.width()>=590 && (currentEvent.enableTrackLiking || currentEvent.enableTrackHating)" size="auto" class="ion-text-nowrap ion-align-self-center workaroundTransparency track-feedback-col">
                            <div *ngIf="currentEvent.enableTrackLiking" class="track-meta">{{currentEvent.emojiTrackLike}} {{item.numLikes ? item.numLikes : 0}}<br/></div>

                            <div *ngIf="currentEvent.enableTrackHating" class="track-meta">{{currentEvent.emojiTrackHate}} {{item.numHates ? item.numHates : 0}}<br/></div>

                        </ion-col>


                        <!-- Provider Logo // Preview Button (Must be always displayed due to legal reasons -->
                        <ion-col size="auto" class="track-provider-col ion-align-self-center workaroundTransparency">
                            <a href="{{item.previewViaApp}} " target="_blank ">
                                <ion-img src="assets/img/spotify/Spotify_Icon_RGB_Green_64.png" class="track-provider-logo" tooltip="Indicates the streaming provider where this track is being played from" [options]="tooltipOptions">
                                </ion-img>
                            </a>
                        </ion-col>


                    </ion-row>
                </ion-grid>

            </ion-col>

            <ion-col size="3">
                <ion-img src="assets/img/event_hdr.jpg"></ion-img>
            </ion-col>
        </ion-row>
    </ion-grid>



</ion-content>